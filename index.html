$Searcher = New-Object DirectoryServices.DirectorySearcher
$Searcher.Filter = "(&(objectCategory=person)(objectClass=user)(!(userAccountControl:1.2.840.113556.1.4.803:=2)))"
$Searcher.PageSize = 1000
$Searcher.PropertiesToLoad.Add("samaccountname") > $null
$Results = $Searcher.FindAll()
$Results | ForEach-Object {
    $u = $_.Properties.samaccountname[0]
    if ($u -and $u -notmatch '^(DEL_|Z-|.*\$|.*admin|.*svc|.*noreply|.*mailbox|.*msol|.*system)') {
        $u
    }
} | Sort-Object -Unique | Out-File CleanUsers.txt
