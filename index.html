$Searcher = New-Object DirectoryServices.DirectorySearcher
$Searcher.Filter = "(objectCategory=person)"
$Searcher.PageSize = 1000
$Searcher.PropertiesToLoad.Add("samaccountname") > $null
$Results = $Searcher.FindAll()
foreach ($Result in $Results) {
    $Result.Properties.samaccountname
}
