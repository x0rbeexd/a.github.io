Get-Content .\computers.txt | ForEach-Object { if (Test-Connection -ComputerName $_ -Count 1 -Quiet) { "$_:$(Resolve-DnsName $_ | Where-Object { $_.Type -eq 'A' } | Select-Object -ExpandProperty IPAddress)" } } > HostToIP.txt
