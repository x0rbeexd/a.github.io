1. Get Current Domain
powershell
Copy
Edit
([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).Name
2. Get Another Domain Object (via ADSI)
powershell
Copy
Edit
# Connect to another domain
$domain = [ADSI]"LDAP://moneycorp.local"
$domain.distinguishedName
⚠️ Requires trust or reachability to moneycorp.local.

3. Get Domain SID
powershell
Copy
Edit
# This gets the SID of the domain via the current user's account SID
$domainSid = ([System.Security.Principal.WindowsIdentity]::GetCurrent()).User.AccountDomainSid.Value
$domainSid
4. Get Domain Policy (like password policy)
powershell
Copy
Edit
secedit /export /cfg C:\windows\temp\secpol.cfg
Select-String "MinimumPasswordLength" C:\windows\temp\secpol.cfg
Or better:

powershell
Copy
Edit
(Get-Content C:\windows\temp\secpol.cfg) -match "^(Password|Lockout|Minimum|Maximum|Enforce).*"
5. LDAP Query for Domain Policy via [ADSI]
powershell
Copy
Edit
$domain = [ADSI]"LDAP://rootDSE"
$policyDN = "LDAP://cn=Default Domain Policy,cn=System," + $domain.defaultNamingContext
$gpo = [ADSI]$policyDN
$gpo.distinguishedName
Parsing actual policy values like systemaccess still requires GPO parsing logic (PowerView does that), or use of tools like LGPO.exe.

