$domain = ([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).Name
$root = "LDAP://$domain"
$searcher = New-Object DirectoryServices.DirectorySearcher
$searcher.SearchRoot = New-Object DirectoryServices.DirectoryEntry($root)
$searcher.Filter = "(&(objectCategory=person)(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=4194304))"
$searcher.PropertiesToLoad.Add("samaccountname") > $null
$searcher.PageSize = 1000
$results = $searcher.FindAll()
$results | ForEach-Object {
    $_.Properties.samaccountname[0]
} | Out-File asrep_candidates.txt
