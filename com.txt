$searcher = New-Object DirectoryServices.DirectorySearcher
$searcher.Filter = "(objectClass=user)"
$searcher.PageSize = 1000
$searcher.PropertiesToLoad.Add("samaccountname") > $null
$searcher.PropertiesToLoad.Add("userAccountControl") > $null
$results = $searcher.FindAll()

foreach ($res in $results) {
    $uac = $res.Properties.useraccountcontrol[0]
    if ($uac -band 4194304) {
        $res.Properties.samaccountname[0]
    }
}
